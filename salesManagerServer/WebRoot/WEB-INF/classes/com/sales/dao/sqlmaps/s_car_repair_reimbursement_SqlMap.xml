<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="s_car_repair_reimbursement" >
  <resultMap id="SCarRepairReimbursementResult" class="com.sales.model.SCarRepairReimbursement" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    <result column="car_reimbursement_id" property="carReimbursementId" jdbcType="INTEGER" />
    <result column="car_reimbursement_code" property="carReimbursementCode" jdbcType="VARCHAR" />
    <result column="reimbursement_time" property="reimbursementTime" jdbcType="DATE" />
    <result column="reimbursement_comment" property="reimbursementComment" jdbcType="VARCHAR" />
    <result column="reimbursement_sum" property="reimbursementSum" jdbcType="REAL" />
    <result column="uppercase" property="uppercase" jdbcType="VARCHAR" />
    <result column="repair_factory_phone" property="repairFactoryPhone" jdbcType="VARCHAR" />
    <result column="car_application_id" property="carApplicationId" jdbcType="INTEGER" />
    <result column="user_id" property="userId" jdbcType="INTEGER" />
    <result column="plate_number" property="plateNumber" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="INTEGER" />
    <result column="user_name" property="userName" jdbcType="VARCHAR" />
    <result column="car_application_code" property="ca.carApplicationCode" jdbcType="VARCHAR" />
  </resultMap>
  <select id="selectByPrimaryKey" resultMap="SCarRepairReimbursementResult" parameterClass="com.sales.model.SCarRepairReimbursement" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    select c.car_reimbursement_id, c.car_reimbursement_code, c.reimbursement_time, c.reimbursement_comment,
      c.reimbursement_sum, c.uppercase, c.repair_factory_phone, c.car_application_id, 
      c.user_id, c.plate_number, c.status, u.user_name, s.car_application_code  
    from s_car_repair_reimbursement c 
    left join s_user u on c.user_id = u.user_id 
    left join s_car_repair_application s on c.car_application_id = s.car_application_id 
    where c.car_reimbursement_id = #carReimbursementId:INTEGER#
  </select>
  <select id="getMaxCode" resultClass="java.lang.String">
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    select max(car_reimbursement_code) from s_car_repair_reimbursement where DATE_FORMAT(reimbursement_time,'%Y-%m-%d')  = curdate()
  </select>
  <delete id="deleteByPrimaryKey" parameterClass="com.sales.model.SCarRepairReimbursement" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    delete from s_car_repair_reimbursement
    where car_reimbursement_id = #carReimbursementId:INTEGER#
  </delete>
  <insert id="insert" parameterClass="com.sales.model.SCarRepairReimbursement" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    insert into s_car_repair_reimbursement (car_reimbursement_id, car_reimbursement_code,
      reimbursement_time, reimbursement_comment, reimbursement_sum, uppercase, repair_factory_phone,
      car_application_id, user_id, plate_number, status)
    values (#carReimbursementId:INTEGER#, #carReimbursementCode:VARCHAR#, #reimbursementTime:TIMESTAMP#,
      #reimbursementComment:VARCHAR#, #reimbursementSum:REAL#, #uppercase:VARCHAR#,
      #repairFactoryPhone:VARCHAR#, #carApplicationId:INTEGER#, #userId:INTEGER#,
      #plateNumber:VARCHAR#, #status:INTEGER#) 
      <selectKey resultClass="int" keyProperty="carReimbursementId">
		select LAST_INSERT_ID() as carReimbursementId
	  </selectKey>
  </insert>
  <update id="updateByPrimaryKey" parameterClass="com.sales.model.SCarRepairReimbursement" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    update s_car_repair_reimbursement
    set car_reimbursement_code = #carReimbursementCode:VARCHAR#,
      reimbursement_time = #reimbursementTime:DATE#,
      reimbursement_comment = #reimbursementComment:VARCHAR#,
      reimbursement_sum = #reimbursementSum:REAL#,
      uppercase = #uppercase:VARCHAR#,
      repair_factory_phone = #repairFactoryPhone:VARCHAR#,
      car_application_id = #carApplicationId:INTEGER#,
      user_id = #userId:INTEGER#,
      plate_number = #plateNumber:VARCHAR#,
      status = #status:INTEGER#
    where car_reimbursement_id = #carReimbursementId:INTEGER#
  </update>
  <update id="updateByPrimaryKeySelective" parameterClass="com.sales.model.SCarRepairReimbursement" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    update s_car_repair_reimbursement
    <dynamic prepend="set" >
      <isNotNull prepend="," property="carReimbursementCode" >
        car_reimbursement_code = #carReimbursementCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="reimbursementTime" >
        reimbursement_time = #reimbursementTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="reimbursementComment" >
        reimbursement_comment = #reimbursementComment:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="reimbursementSum" >
        reimbursement_sum = #reimbursementSum:REAL#
      </isNotNull>
      <isNotNull prepend="," property="uppercase" >
        uppercase = #uppercase:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="repairFactoryPhone" >
        repair_factory_phone = #repairFactoryPhone:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="carApplicationId" >
        car_application_id = #carApplicationId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="userId" >
        user_id = #userId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="plateNumber" >
        plate_number = #plateNumber:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status" >
        status = #status:INTEGER#
      </isNotNull>
    </dynamic>
    where car_reimbursement_id = #carReimbursementId:INTEGER#
  </update>
  
  <select id="getCarReimbursementListPage" resultMap="SCarRepairReimbursementResult" parameterClass="com.sales.model.SCarRepairReimbursement" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    select c.car_reimbursement_id, c.car_reimbursement_code, c.reimbursement_time, c.reimbursement_comment,
      c.reimbursement_sum, c.uppercase, c.repair_factory_phone, c.car_application_id, 
      c.user_id, c.plate_number, c.status, u.user_name, s.car_application_code  
    from s_car_repair_reimbursement c 
    left join s_user u on c.user_id = u.user_id 
    left join s_car_repair_application s on c.car_application_id = s.car_application_id 
    <dynamic prepend="where">
        <isNotEmpty prepend="and" property="userId">
			c.user_id = #userId# 
		</isNotEmpty>
        <isNotEmpty prepend="and" property="reimbursementTime">
			c.reimbursement_time = #reimbursementTime# 
		</isNotEmpty>
		
	</dynamic>
	order by c.reimbursement_time desc 
	<dynamic prepend="limit">
		<isNotNull property="pageStart">
			<isNotNull property="pageSize">#pageStart#, #pageSize#</isNotNull>
		</isNotNull>
	</dynamic>
  </select>
  
  <select id="getCarReimbursementListPageCount" resultClass="java.lang.Integer" parameterClass="com.sales.model.SCarRepairReimbursement" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    select count(c.car_reimbursement_id)   
    from s_car_repair_reimbursement c 
    left join s_user u on c.user_id = u.user_id 
    left join s_car_repair_application s on c.car_application_id = s.car_application_id 
    <dynamic prepend="where">
        <isNotEmpty prepend="and" property="userId">
			c.user_id = #userId# 
		</isNotEmpty>
        <isNotEmpty prepend="and" property="reimbursementTime">
			c.reimbursement_time = #reimbursementTime# 
		</isNotEmpty>
		
	</dynamic>
  </select>
</sqlMap>