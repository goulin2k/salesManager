<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="s_log" >
  <resultMap id="SLogResult" class="com.sales.model.SLog" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    <result column="log_id" property="logId" jdbcType="INTEGER" />
    <result column="type_id" property="typeId" jdbcType="INTEGER" />
    <result column="title" property="title" jdbcType="VARCHAR" />
    <result column="operate_user_id" property="operateUserId" jdbcType="INTEGER" />
    <result column="log_time" property="logTime" jdbcType="TIMESTAMP" />
    <result column="log_content" property="logContent" jdbcType="VARCHAR" />
    <result column="user_name" property="userName" jdbcType="VARCHAR" />
  </resultMap>
  <select id="selectByPrimaryKey" resultMap="SLogResult" parameterClass="com.sales.model.SLog" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    select l.log_id, l.type_id, l.title, l.operate_user_id, l.log_time, l.log_content, u.user_name
    from s_log l left join s_user u on l.operate_user_id = u.user_id 
    where l.log_id = #logId:INTEGER#
  </select>
  <delete id="deleteByPrimaryKey" parameterClass="com.sales.model.SLog" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    delete from s_log
    where log_id = #logId:INTEGER#
  </delete>
  <insert id="insert" parameterClass="com.sales.model.SLog" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    insert into s_log (log_id, type_id, title, operate_user_id, log_time, log_content)
    values (#logId:INTEGER#, #typeId:INTEGER#, #title:VARCHAR#, #operateUserId:INTEGER#,
      #logTime:TIMESTAMP#, #logContent:VARCHAR#)
  </insert>
  <update id="updateByPrimaryKey" parameterClass="com.sales.model.SLog" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    update s_log
    set type_id = #typeId:INTEGER#,
      title = #title:VARCHAR#,
      operate_user_id = #operateUserId:INTEGER#,
      log_time = #logTime:TIMESTAMP#,
      log_content = #logContent:VARCHAR#
    where log_id = #logId:INTEGER#
  </update>
  <update id="updateByPrimaryKeySelective" parameterClass="com.sales.model.SLog" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Tue Apr 23 17:36:30 CST 2013.
    -->
    update s_log
    <dynamic prepend="set" >
      <isNotNull prepend="," property="typeId" >
        type_id = #typeId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="title" >
        title = #title:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="operateUserId" >
        operate_user_id = #operateUserId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="logTime" >
        log_time = #logTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="logContent" >
        log_content = #logContent:VARCHAR#
      </isNotNull>
    </dynamic>
    where log_id = #logId:INTEGER#
  </update>
  
  <select id="getLogListPage" resultMap="SLogResult" parameterClass="com.sales.model.SLog" >
    select l.log_id, l.type_id, l.title, l.operate_user_id, l.log_time, l.log_content, u.user_name
    from s_log l left join s_user u on l.operate_user_id = u.user_id 
    <dynamic prepend="where">
		<isNotNull property="typeId">
		    <isNotEqual prepend="and" property="typeId" compareValue="0">
			    l.type_id = #typeId#
			</isNotEqual>
		</isNotNull>
		<isNotEmpty prepend="and" property="title">
			l.title like '%$title$%' 
		</isNotEmpty>
		<isNotEmpty prepend="and" property="logTime">
			l.log_time = #logTime#
		</isNotEmpty>
	</dynamic>
	order by l.log_time desc
	<dynamic prepend="limit">
		<isNotNull property="pageStart">
			<isNotNull property="pageSize">#pageStart#, #pageSize#</isNotNull>
		</isNotNull>
	</dynamic>
  </select>
  
  <select id="getLogListPageCount" resultClass="java.lang.Integer" parameterClass="com.sales.model.SLog" >
    select count(l.log_id) 
    from s_log l
    <dynamic prepend="where">
		<isNotNull property="typeId">
			<isNotEqual prepend="and" property="typeId" compareValue="0">
			    l.type_id = #typeId#
			</isNotEqual>
		</isNotNull>
		<isNotEmpty prepend="and" property="title">
			l.title like '%$title$%' 
		</isNotEmpty>
		<isNotEmpty prepend="and" property="logTime">
			l.log_time = #logTime#
		</isNotEmpty>
	</dynamic>
  </select>
</sqlMap>