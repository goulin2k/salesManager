<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="s_performance_plan" >
  <resultMap id="SPerformancePlanResult" class="com.sales.model.SPerformancePlan" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Wed May 15 09:36:54 CST 2013.
    -->
    <result column="plan_id" property="planId" jdbcType="INTEGER" />
    <result column="cycle_id" property="cycleId" jdbcType="INTEGER" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="suitable_post_id" property="suitablePostId" jdbcType="INTEGER" />
    <result column="post_type" property="postType" jdbcType="INTEGER" />
    <result column="user_id" property="userId" jdbcType="INTEGER" />
    <result column="create_time" property="createTime" jdbcType="DATE" />
    <result column="positionName" property="suitablePostName" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="SPerformancePlanAndItemsResult" class="com.sales.model.SPerformancePlan" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Wed May 15 09:36:54 CST 2013.
    -->
    <result column="plan_id" property="planId" jdbcType="INTEGER" />
    <result column="cycle_id" property="cycleId" jdbcType="INTEGER" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="suitable_post_id" property="suitablePostId" jdbcType="INTEGER" />
    <result column="post_type" property="postType" jdbcType="INTEGER" />
    <result column="user_id" property="userId" jdbcType="INTEGER" />
    <result column="create_time" property="createTime" jdbcType="DATE" />
        <result column="positionName" property="suitablePostName" jdbcType="VARCHAR" />
    <result property="itemList" column="plan_id" select="s_performance_item.getPlanItemList"/>   
  </resultMap>
  <select id="selectByPrimaryKey" resultMap="SPerformancePlanAndItemsResult" parameterClass="com.sales.model.SPerformancePlan" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Wed May 15 09:36:54 CST 2013.
    -->
    select p.plan_id, p.cycle_id, p.name, p.suitable_post_id, p.post_type, p.user_id, 
    p.create_time, s.name as positionName 
    from s_performance_plan p left join s_position s on p.suitable_post_id = s.position_id 
    where p.plan_id = #planId:INTEGER#
  </select>
  <delete id="deleteByPrimaryKey" parameterClass="com.sales.model.SPerformancePlan" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Wed May 15 09:36:54 CST 2013.
    -->
    delete from s_performance_plan
    where plan_id = #planId:INTEGER#
  </delete>
  <insert id="insert" parameterClass="com.sales.model.SPerformancePlan" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Wed May 15 09:36:54 CST 2013.
    -->
    insert into s_performance_plan (plan_id, cycle_id, name, suitable_post_id, post_type, user_id,
      create_time)
    values (#planId:INTEGER#, #cycleId:INTEGER#, #name:VARCHAR#, #suitablePostId:INTEGER#,
      #postType:INTEGER#, #userId:INTEGER#, #createTime:DATE#) 
      <selectKey resultClass="int" keyProperty="planId">
		select LAST_INSERT_ID() as planId
	  </selectKey>
  </insert>
  <update id="updateByPrimaryKey" parameterClass="com.sales.model.SPerformancePlan" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Wed May 15 09:36:54 CST 2013.
    -->
    update s_performance_plan
    set cycle_id = #cycleId:INTEGER#,
      name = #name:VARCHAR#,
      suitable_post_id = #suitablePostId:INTEGER#,
      post_type = #postType:INTEGER#,
      user_id = #userId:INTEGER#,
      create_time = #createTime:DATE#
    where plan_id = #planId:INTEGER#
  </update>
  <update id="updateByPrimaryKeySelective" parameterClass="com.sales.model.SPerformancePlan" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Wed May 15 09:36:54 CST 2013.
    -->
    update s_performance_plan
    <dynamic prepend="set" >
      <isNotNull prepend="," property="cycleId" >
        cycle_id = #cycleId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="name" >
        name = #name:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="suitablePostId" >
        suitable_post_id = #suitablePostId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="postType" >
        post_type = #postType:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="userId" >
        user_id = #userId:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="createTime" >
        create_time = #createTime:DATE#
      </isNotNull>
    </dynamic>
    where plan_id = #planId:INTEGER#
  </update>
  
  <select id="getPlanListPage" resultMap="SPerformancePlanResult" parameterClass="com.sales.model.SPerformancePlan" >
    select p.plan_id, p.cycle_id, p.name, p.suitable_post_id, p.post_type, p.user_id, 
    p.create_time, s.name as positionName 
    from s_performance_plan p left join s_position s on p.suitable_post_id = s.position_id 
    <dynamic prepend="where">
		<isNotEmpty prepend="and" property="name">
			p.name like '%$name$%' 
		</isNotEmpty>
		<isNotEmpty prepend="and" property="suitablePostId">
			p.suitable_post_id = #suitablePostId# 
		</isNotEmpty>
	</dynamic>
	<dynamic prepend="limit">
		<isNotNull property="pageStart">
			<isNotNull property="pageSize">#pageStart#, #pageSize#</isNotNull>
		</isNotNull>
	</dynamic>
  </select>
  
  <select id="getPlanListPageCount" resultClass="java.lang.Integer" parameterClass="com.sales.model.SPerformancePlan" >
    select count(plan_id) 
    from s_performance_plan p left join s_position s on p.suitable_post_id = s.position_id 
    <dynamic prepend="where">
		<isNotEmpty prepend="and" property="name">
			p.name like '%$name$%' 
		</isNotEmpty>
		<isNotEmpty prepend="and" property="suitablePostId">
			p.suitable_post_id = #suitablePostId# 
		</isNotEmpty>
	</dynamic>
  </select>
</sqlMap>